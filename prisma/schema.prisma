// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql" // change to "mysql" or "sqlite" if needed
  url      = env("DATABASE_URL")
}

model User {
  user_id             Int        @id @default(autoincrement())
  email               String     @unique
  password_hash       String
  phone               String?    @unique
  role                String     // tenant | landlord | lister
  profile_data        Json?
  verification_status Boolean    @default(false)
  created_at          DateTime   @default(now())
  updated_at          DateTime   @updatedAt

  // Relations
  landlordProperties  Property[] @relation("LandlordProperties")
  listerProperties    Property[] @relation("ListerProperties")
  bookings            Booking[]
}

model Property {
  property_id Int       @id @default(autoincrement())
  landlord_id Int
  lister_id   Int?
  title       String
  description String?
  created_at  DateTime  @default(now())
  updated_at  DateTime  @updatedAt

  // Relations
  landlord User     @relation("LandlordProperties", fields: [landlord_id], references: [user_id])
  lister   User?    @relation("ListerProperties", fields: [lister_id], references: [user_id])
  bookings Booking[]
}

model Booking {
  booking_id  Int      @id @default(autoincrement())
  user_id     Int
  property_id Int
  created_at  DateTime @default(now())

  // Relations
  user     User     @relation(fields: [user_id], references: [user_id])
  property Property @relation(fields: [property_id], references: [property_id])
}
